<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>The Pot Game</title>

    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">

    <link rel="stylesheet" href="../css/styles.css">

</head>

<body>
    <nav class="navbar navbar-inverse navbar-fixed-top">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="#">The Pot</a>
            </div>
            <div id="navbar" class="collapse navbar-collapse">
                <ul class="nav navbar-nav">
                    <li class="active"><a href="#">Home</a></li>
                    <li><a href="#about">About</a></li>
                    <li><a href="#rules">The Rules</a></li>
                    <li><a href="#contact">Contact</a></li>
                </ul>
            </div>
            <!--/.nav-collapse -->
        </div>
    </nav>

    <div class="container">
        <div class="page-header">
            <h1>Group Definition</h1>
        </div>
        <div class="group">
            <h2>Group 1</h2>
            <form class="form-inline">
                <div class="form-group">
                    <label for="group1name">Name:</label>
                    <input type="text" class="form-control" id="group1Name" value="Group 1">
                </div>
            </form>
            <label for="group1-members">Number of members:</label>
            <label class="radio-inline">
                <input type="radio" name="group1Members" id="g1members2" value="2" checked> 2
            </label>
            <label class="radio-inline">
                <input type="radio" name="group1Members" id="g1members3" value="3"> 3
            </label>
            <label class="radio-inline">
                <input type="radio" name="group1Members" id="g1members4" value="4"> 4
            </label>
            <label class="radio-inline">
                <input type="radio" name="group1Members" id="g1members5" value="5"> 5
            </label>
            <label class="radio-inline">
                <input type="radio" name="group1Members" id="g1members6" value="6"> 6
            </label>
            <label class="radio-inline">
                <input type="radio" name="group1Members" id="g1members7" value="7"> 7
            </label>
            <label class="radio-inline">
                <input type="radio" name="group1Members" id="g1members8" value="8"> 8
            </label>
            <label class="radio-inline">
                <input type="radio" name="group1Members" id="g1members9" value="9"> 9
            </label>
            <!-- Se inserta inputs para nombre de miembros -->
            <form class="form-inline" id="group1-name-form"></form>
        </div>

        <div class="group">
            <h2>Group 2</h2>
            <form class="form-inline">
                <div class="form-group">
                    <label for="group2name">Name:</label>
                    <input type="text" class="form-control" id="group2Name" value="Group 2">
                </div>
            </form>
            <label for="group2-members">Number of members:</label>
            <label class="radio-inline">
                <input type="radio" name="group2Members" id="g2members2" value="2" checked> 2
            </label>
            <label class="radio-inline">
                <input type="radio" name="group2Members" id="g2members3" value="3"> 3
            </label>
            <label class="radio-inline">
                <input type="radio" name="group2Members" id="g2members4" value="4"> 4
            </label>
            <label class="radio-inline">
                <input type="radio" name="group2Members" id="g2members5" value="5"> 5
            </label>
            <label class="radio-inline">
                <input type="radio" name="group2Members" id="g2members6" value="6"> 6
            </label>
            <label class="radio-inline">
                <input type="radio" name="group2Members" id="g2members7" value="7"> 7
            </label>
            <label class="radio-inline">
                <input type="radio" name="group2Members" id="g2members8" value="8"> 8
            </label>
            <label class="radio-inline">
                <input type="radio" name="group2Members" id="g2members9" value="9"> 9
            </label>
            <form class="form-inline" id="group2-name-form"></form>
        </div>

    </div>

    <div class="container">
        <hr>
        <form class="form-inline">
            <div class="form-group">
                <label for="wordsPerMember">Words per Member:</label>
                <input type="text" class="form-control" id="wordsPerMemberInput" value="10">
            </div>
        </form>
        <form class="form-inline">
            <div class="form-group">
                <label for="timePerTurn">Time per Turn [s]:</label>
                <input type="text" class="form-control" id="timePerTurnInput" value="30">
            </div>
        </form>
    </div>

    <div class="container">

        <div class="starter-template">
            <a class="btn btn-lg btn-success" href=title.html role="button">Back</a>
            <a class="btn btn-lg btn-primary" href=wordChoosing.html id="wordChoosing" role="button">Next</a>
        </div>
    </div>

    <!-- Se compilan scripts -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../js/formGenerator.js"></script>
    <script type="text/javascript" src="../js/group.js"></script>
    <script type="text/javascript" src="../js/groupSet.js"></script>
    <script type="text/javascript" src="../js/storage.js"></script>
    <script type="text/javascript" src="../js/sanityCheck.js"></script>

    <!-- Set variables script -->
    <script>
        // Activa las funciones generadoras de FORMULARIOS
        var changeInputs = function(i) {
            return function() {
                var oldNames = {};
                $.each($('[id^=group' + i + 'Member]'), function(k, v) {
                    oldNames[k] = $(v).val();
                });
                $('#group' + i + '-name-form')
                    .empty()
                    .append(generateNameForm(i, $('input[name=group' + i + 'Members]:checked').val(), oldNames));
            };
        };

        for (var i = 1; i <= $('.group').length; i++) {
            $('input[name=group' + i + 'Members]').on('change', changeInputs(i))
            $('input[name=group' + i + 'Members]').trigger('change');
        }

        $('#wordChoosing').on('click', function() {
            var groups = GroupSet();
            for (var i = 1; i <= $('.group').length; i++) {
                var groupName = $('#group' + i + 'Name').val();
                var memberNames = $.map($('[id^=group' + i + 'Member]'), function(e) {
                    return $(e).val();
                });
                groups.addGroup(Group(groupName, memberNames));
            }
            
            var timePerTurn = $('#timePerTurnInput').val();
            var wordsPerMember = $('#wordsPerMemberInput').val();
            
            // sanity check
            if (groups.isSane() && checkInteger(timePerTurn) && checkInteger(wordsPerMember)) {
                $('#wordChoosing').attr('href', 'wordChoosing.html');
            }
            else {
                window.alert('The form contains errors!');
                $('#wordChoosing').attr('href', '#');
            }
            
            saveGroups(groups);
            localStorage.setItem('wordsPerMember', wordsPerMember);
            localStorage.setItem('timePerTurn', timePerTurn);

        });
    </script>

</body>

</html>
